<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Chess.Magic</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Chess-Magic.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">chess</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Chess.Magic</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">properties
</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>The magic bit board database
</p><p>The database helps quickly determining in run time the sliding pieces
   (Rook, Bishop) attack BitBoards including blocking piece checks. The
   total run time is a 64 entry lookup (per piece type) obtaining the magic
   dataset.
   From there we have the magicNumber which then can be used (involving 64-bit
   multiplication) combined with the current board occupancy BitBoard to obtain
   the magicIndex. This gives the desired BitBoard with the attacked
   positions set (including capturable pieces). The returned position does not
   distinguish between colours, therefore one might need to and the resulting
   BitBoard with the negate of the friendly pieces.
</p><p>The per piece span varies on the 64 entry position, for rooks the maximal
   required span address width is 12 for any position. (12 is maximum of
   attackable non-edge squares with a rook). 1 entry is 64 bits, therefore
   the maximal database size is 8 bytes * (2 ^ 12 span width) * 64 entries.
   This is 2Mb however due to the fancy-BitBoard packing (spans are packed
   with no gaps) it is believed that we can go down to ~800Kb.
   For bishops the database is significantly smaller.
</p><p>See:
</p><ul><li> the StockFish source code <a href="https://github.com/mcostalba/Stockfish">https://github.com/mcostalba/Stockfish</a>
</li><li> <a href="http://www.rivalchess.com/magic-bitboards">http://www.rivalchess.com/magic-bitboards</a>
</li><li> <a href="http://chessprogramming.wikispaces.com/Magic+Bitboards">http://chessprogramming.wikispaces.com/Magic+Bitboards</a>
</li></ul></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span>  <a href="#t:Magic">Magic</a> </li><li class="src short"><a href="#v:magic">magic</a> :: <a href="Data-ChessTypes.html#t:PieceType">PieceType</a> -&gt; <a href="Data-Square.html#t:Square">Square</a> -&gt; <a href="Data-BitBoard-BitBoard.html#t:BitBoard">BitBoard</a> -&gt; <a href="Data-BitBoard-BitBoard.html#t:BitBoard">BitBoard</a></li><li class="src short"><a href="#v:prop_slidingAttack">prop_slidingAttack</a> :: <a href="Data-BitBoard-BitBoard.html#t:BitBoard">BitBoard</a> -&gt; <a href="Data-Square.html#t:Square">Square</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/QuickCheck/latest/doc/html/Test-QuickCheck-Property.html#t:Property">Property</a></li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:Magic" class="def">Magic</a>  </p><div class="doc"><p>The magic database ( for a Bishop or a Rook )
</p></div></div><div class="top"><p class="src"><a name="v:magic" class="def">magic</a> :: <a href="Data-ChessTypes.html#t:PieceType">PieceType</a> -&gt; <a href="Data-Square.html#t:Square">Square</a> -&gt; <a href="Data-BitBoard-BitBoard.html#t:BitBoard">BitBoard</a> -&gt; <a href="Data-BitBoard-BitBoard.html#t:BitBoard">BitBoard</a></p></div><h1 id="g:1">properties
</h1><div class="top"><p class="src"><a name="v:prop_slidingAttack" class="def">prop_slidingAttack</a> :: <a href="Data-BitBoard-BitBoard.html#t:BitBoard">BitBoard</a> -&gt; <a href="Data-Square.html#t:Square">Square</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/QuickCheck/latest/doc/html/Test-QuickCheck-Property.html#t:Property">Property</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.13.2</p></div></body></html>